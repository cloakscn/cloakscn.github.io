# 嵌入式基础知识（编制中）

## 嵌入式系统的组成及特点

嵌入式系统（Embedded System）是以特定应用为中心、以计算机技术为基础，并将可配置与可裁剪的软、硬件集成于一体的专用计算机系统。嵌入式系统的组成结构是：

1. 嵌入式处理器，除满足低功耗、体积小等需求外，工艺可分为民用、工业和军用等三个档次，民用级器件的工作温度范围是 0～70℃、工业级的是−40～85℃、军用级的是−55～150℃。其应用环境常常非常恶劣，比如有高温、寒冷、电磁、震动、烟尘等环境因素。
2. 相关支撑硬件，指除处理器以外的其他硬件，如存储器、定时器、总线等。
3. 嵌入式操作系统，与通用操作系统不同，嵌入式操作系统应具备 **实时性、可裁剪性和安全性** 等特征。
4. 支撑软件，其中的公共服务通常运行在操作系统之上，以库的方式被应用软件所引用。
5. 应用软件，是指为完成嵌入式系统的某一专用目标所开发的软件。

**嵌入式系统的特点**

1. 专用性强，常常面向特定应用需求，配备多种传感器。
2. 技术融合，将先进的计算机技术、通信技术、半导体技术和电子技术与各个行业的具体应用紧密结合难以拆分。
3. 软硬一体软件为主，在通用的嵌入式系统版本基础上裁剪冗余，高效设计。
4. 资源受限，由于低功耗、体积小和集成度高等要求，系统的资源非常少。
5. 程序代码固化在 ROM 中，以提高执行速度和系统可靠性。
6. 需专门开发工具和环境。
7. 体积小、价格低、工艺先进、性能价格比高、系统配置要求低、实时性强。
8. 对安全性和可靠性的要求高。

!!! info "2012 综合知识 10"

    在嵌入式系统开发中，由于嵌入式设备不具备足够的处理器能力和存储空间，程序开发一般用 PC (宿主机）来完成，然后将可执行文件下载到嵌入式系统（目标机）中运行。
    
    当宿主机与目标机的机器指令不同时，就需要交叉工具链（指编译、汇编、链接等一整套工具）。

## 嵌入式系统的分类

### 分类

根据不同用途可将嵌入式系统划分为 **嵌入式实时系统** 和 **嵌入式非实时系统** 两种。而实时系统又可分为 **强实时（Hard Real-Time）系统** 和 **弱实时（Weak Real-Time）系统**。从安全性要求看，嵌入式系统还可分为 **安全攸关（Safety-Critical 或 Life-Critical）系统** 和 **非安全攸关系统**。

### 实时系统

实时系统（Real-Time System，RTS）是指能够在规定的时间内完成系统功能和做出响应的系统。

!!! info "2012 综合知识 12"

    一个嵌入式实时操作系统（RTOS)的评价要从很多角度进行，如体系结构、API 的丰富程度、网络支持、可靠性等。其中，实时性是 RTOS 评价的最重要的指标之一， 实时性的优劣是用户选择操作系统的一个重要参考。
    
    严格地说，影响嵌入式操作系统实时性的因素有很多，如常用 **系统调用平均运行时间、任务切换时间、线程切换时间、信号量混洗时间（指从一个任务释放信号量到另一 个等待该信号量的任务被激活的时间延迟)、中断响应时间等。**
    
    任务执行时间不是反映 RTOS 实时性的评价指标。

### 安全攸关系统

安全攸关系统（Safety-Critical System）是指其不正确的功能或者失效会导致人员伤亡、财产损失等严重后果的计算机系统。

## 嵌入式软件的组成及特点

大多数嵌入式系统都具备实时特征，这种嵌入式系统的典型架构可概括为两种模式，即 **层次化模式架构** 和 **递归模式架构**。

嵌入式系统的最大特点就是系统的运行和开发是在不同环境中进行的，通常将运行环境称为“目标机”环境，称开发环境为“宿主机”环境，宿主机与目标机之间通过串口、网络或 JTAG 接口连接。由于宿主机和目标机的指令往往是不同的，嵌入式系统的开发通常需要交叉平台开发环境支持，基本开发工具是交叉编译器、交叉链接器和源代码调试器。还需要注意 **实时性、安全性和可靠性、代码规模、软/硬件协同工作的效率和稳定性、特定领域的需求等。**

从细节上看，嵌入式系统可以分为：

1. **硬件层**，包括处理器、存储器、总线、I/O 接口及电源、时钟等。
2. **抽象层**，包括硬件抽象层（HAL），为上层应用（操作系统）提供虚拟的硬件资源；板级支持包（BSP），是一种硬件驱动软件，为上层操作系统提供对硬件进行管理的支持。
3. **操作系统层**，由嵌入式操作系统、文件系统、图形用户接口、网络系统和通用组件等可配置模块组成。
4. **中间件层**，是连接两个独立应用的桥梁，常用的有嵌入式数据库、OpenGL、消息中间件、Java 中间件、虚拟机（VM）、DDS/CORBA 和 Hadoop 等。
5. **应用层**，包括不同的应用软件。

嵌入式软件的主要特点有：

1. **可剪裁性：** 设计方法包括静态编译、动态库和控制函数流程实现功能控制等。
2. **可配置性：** 设计方法包括数据驱动、静态编译和配置表等。
3. **强实时性：** 设计方法包括表驱动、配置、静/动态结合、汇编语言等。
4. **安全性（Safety）：** 设计方法包括编码标准、安全保障机制、FMECA（故障模式、影响及危害性分析）。
5. **可靠性：** 设计方法包括容错技术、余度技术和鲁棒性设计等。
6. **高确定性：** 设计方法包括静态分配资源、越界检查、状态机、静态任务调度等。综上所述，嵌入式软件的开发也与传统的软件开发方法差异较大。在嵌入式系统设计时，要进行低功耗设计。主要技术有编译优化技术、软硬件协同设计、算法优化。

!!! info "2012 综合知识 11"

    硬件抽象层是位于操作系统内核与硬件电路之间的接口层，其目的在于将硬件抽象化。它隐藏了特定平台的硬件接口细节，为操作系统提供虚拟硬件平台，使其具有硬件无关性，可在多种平台上进行移植。

## 嵌入式系统硬件体系结构

## 安全攸关软件的安全性设计

