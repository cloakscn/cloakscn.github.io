# 通信系统架构设计理论与实践

通信网络主要形式：局域网、广域网、移动通信网。

## 通信系统网络架构

### 局域网网络架构

局域网是单一机构专用计算机的网络。通常由计算机、交换机、路由器等设备组成。特点是覆盖地理范围小、数据传输速率高、低误码率、可靠性高、支持多种传输介质、支持实时应用。局域网按网络拓扑分类有总线型、环型、星型、树型、层次型等类型，按传输介质分类有有线局域网、无线局域网。

局域网网络架构有 4 种类型：

<div class="grid cards" markdown>

- 单核心架构

    ---

    使用单台核心二层或三层交换设备作为网络核心。

    优点：结构简单，设备投资节约，接入方便。

    缺点：地理范围受限，核心单点故障，扩展能力有限，接入设备较多时核心端口密度要求高。

- 双核心架构

    ---

    采用两台核心三层及以上交换机作为网络核心。

    优点：网络拓扑结构可靠性高，接入较为方便。

    缺点：投资较单核心高，核心端口密度要求较高。

- 环型架构

    ---

    采用多台核心三层及以上交换机组成双动态弹性分组环（Resilient Packet Ring，RPR），作为网络核心。

    优点：RPR 具备自愈保护，节省光纤资源，提供多等级、可靠的 QoS 服务，有效利用带宽资源。

    缺点：投资较高，路由冗余设计实施难度较高且易形成环路，多环智能通过业务接口互通无法直通。

- 层次型架构

    ---

    由核心层、汇聚层、接入层三层交换设备和用户设备组成层次模型。

    1. 核心层：负责高速数据转发。
    2. 汇聚层：提供充足接口，与接入层间实现互访控制。
    3. 接入层：用户设备接入。

    层次型架构的优点：易扩展，分级排查网络故障便于维护。 

</div>

### 广域网网络架构

广域网利用公用分组交换网、无线分组交换网、卫星通信网构建通信子网连接分布的局域网以实现资源子网的共享。广域网由骨干网、分布网、接入网组成。广域网网络架构可以分为：

1. 单核心架构。以单台核心三层交换设备作为网络核心。

    优点：结构简单，设备投资节约，局域网互访效率高，新局域网接入方便。

    缺点：核心单点故障，扩展能力欠佳，核心设备端口密度要求较高。

2. 双核心架构。以两台核心三层及以上交换机作为网络核心。

    优点：网络拓扑结构可靠，路由可热切换，可靠性高，局域网接入较为方便。

    缺点：投资较单核心高，路由冗余设计实施难度较高，核心端口密度要求较高。

3. 环型架构。以多台核心三层及以上交换机组成路由环路作为网络核心。

    优点：接入方便。

    缺点：投资较高，路由冗余设计实施难度较高且易形成环路，核心端口密度要求较高。

4. 半/全冗余架构。以多台核心路由设备间互连组成网络核心，如任意核心存在两条以上到其他核心的链路为半冗余架构，如任何两个核心间均存在链路为全冗余架构。

    优点：结构灵活，路由灵活，方便扩展，可靠性高。

    缺点：结构零散，不便管理，不便排障。

5. 对等子域架构。将半冗余核心划为两个独立子域，子域间通过一条或多条链路互连。

    优点：路由控制灵活。
    缺点：子域间冗余设计实施难度较高，易形成环路或存在非法路由风险，子域互连设备性能要求高。

6. 层次子域架构。半冗余核心划为多个独立子域，子域间存在层次关系，高层次子域连接多个低层次子域。

    优点：扩展性较好，路由控制灵活。
    缺点：子域路由冗余设计实施难度较高，易形成环路或存在非法路由风险，子域互连设备性能要求高。

### 移动通信网网络架构

5G 系统为移动终端用户提供数据网络互连，数据网络可以是互联网、IP 媒体子系统、专用网络。用户设备通过 5G 系统接入数据网络的方式有透明模式和非透明模式。在透明模式下 5G 系统通过用户面功能接口接入运营商网络，然后通过防火墙或者代理连至 Internet。非透明模式下，5G系统可以直接或通过其他网络连接至运营商网络或 Internet。

### 5G 网络边缘计算

5G 网络边缘计算能为垂直行业提供诸如以时间敏感、高带宽为特征的业务就近分流服务。一来为用户提供极佳的服务体验，二来降低了移动网络后端处理的压力。

### 软件定义网络

软件定义网络（Software Defined Network, SDN）是一种新型网络创新架构，核心思想是通过控制与转发分离，将网络中交换设备的控制逻辑集中到一个计算设备上，控制面集中管控，提升网络管理配置能力。

!!! tip

    SDN 利用分层的思想，将网络分为控制层和数据层。

### 存储网络架构

存储网络设计磁盘存储访问方式：直连式存储，网络附加存储，存储区域网络。

1. 直连式存储（Direct Attached Storage，DAS）：存储设备通过 IDE/ATA/SCSI 接口或光纤通道直接连接到单台计算机，计算机通过 I/O 访问存储设备，存储设备可以是硬盘驱动器、RAID阵列、CD、DVD、磁带驱动器。
2. 网络附加存储（Network Attached Storage，NAS）：存储设备通过标准的网络拓扑结构连接到计算机群组，计算机通过 IP 局域网或广域网 TPC 或 UDP 协议，通过 RPC 接口访问 NAS 存储设备。
3. 存储区域网络（Storage Area Network，SAN）：一种采用网状通道技术专门为存储建立的独立于 TCP/IP 网络之外的专用网络，通过网状通道交换机连接存储阵列和服务器。

| 比较项   | DAS           | NAS           | SAN           |
|----------|---------------|---------------|---------------|
| 架构类别 | 单机存储架构  | 网络存储架构  | 网络存储架构  |
| 访问方式 | I/O 总线      | 网络          | 网络          |
| 资源利用 | 单机存储      | 共享存储      | 共享存储      |
| 访问媒介 | 总线          | 以太网        | 以太网/光纤通道 |
| 优势特点 | 易用易管理<br>设备成本低 | 易用易管理<br>可扩展性高<br>设备成本较低 | 高性能<br>低延迟<br>灵活性高 |

!!! info "2012 综合知识 15"

    DAS (Direct Attached Storage,直接附加存储）即直连方式存储。在这种方式中，存储设备是通过电缆（通常是 SCSI 接口电缆）直接连接服务器。I/O (输入/输入）请求直接发送到存储设备。DAS 也可称为 SAS ( Server Attached Storage,服务器附加存储）。它依赖于服务器，其本身是硬件的堆叠，不带有任何存储操作系统，DAS 不能提供跨平台文件共享功能，各系统平台下文件需分别存储。
    
    NAS 是（Network Attached Storage)的简称，中文称为网络附加存储。在 NAS 存储结构中，存储系统不再通过 I/O 总线附属于某个特定的服务器或客户机，而是直接通过网络接口与网络直接相连，由用户通过网络来访问。
    
    NAS 设备有自己的 OS，其实际上是一个带有瘦服务的存储设备，其作用类似于一个专用的文件服务器，不过把显示器，键盘，鼠标等设备省去，NAS 用于存储服务，可以大大降低了存储设备的成本，另外 NAS 中的存储信息都是采用 RAID 方式进行管理的， 从而有效的保护了数据。
    
    SAN 是通过专用高速网将一个或多个网络存储设备和服务器连接起来的专用存储系统，未来的信息存储将以 SAN 存储方式为主。SAN 主要采取数据块的方式进行数据和信息的存储，目前主要使用于以太网（IPSAN)和光纤通道（FCSAN)两类环境中。

!!! info "2015 综合知识 14"

    RAID 是英文 Redundant Arrayof Independent Disks 的缩写，中文简称为独立冗余磁盘阵列。简单地说，RAID 是一种把多块独立的硬盘(物理硬盘)按不同的方式组合起来形成一个硬盘组(逻辑硬盘)，从而提供比单个硬盘更高的存储性能和提供数据备份技术。组成磁盘阵列的不同方式称为 RAID 级别(RAID Levels)。在用户看起来，组成的磁盘组就像是一个硬盘，用户可以对它进行分区，格式化等。总之，对磁盘阵列的操作与单个硬盘一模一样。不同的是，磁盘阵列的存储速度要比单个硬盘高很多，而且可以提供自动数据备份。数据备份的功能是在用户数据一旦发生损坏后，利用备份信息可以使损坏数据得以恢复，从而保障了用户数据的安全性。
    
    RAID 技术分为几种不同的等级，分别可以提供不同的速度，安全性和性价比。根据实际情况选择适当的 RAID 级别可以满足用户对存储系统可用性、性能和容量的要求。常用的 RAID 级别有以下几种：NRAID，JBOD，RAIDO，RAID1，RAID1+0，RAID3，RAID5 等。目前经常使用的是 RAID5 和 RAID(1+0)。**如果使用物理硬盘容量不相等的硬盘做RAID，那么创建的 RAID 阵列的总容量为较小的硬盘的计算方式。**

    RAID5 的存储机制是两块存数据，一块存另外两块硬盘的交易校验结果。RAID5 的建立后，坏掉一块硬盘，可以通过另外两块硬盘的数据算出第三块的，所以至少要 3 块。RAID5是一种旋转奇偶校验独立存取的阵列方式，它与 RAID3，RAID4 不同的是没有固定的校验盘，而是按某种规则把奇偶校验信息均匀地分布在阵列所属的硬盘上，所以在每块硬盘上，既有数据信息也有校验信息。这一改变解决了争用校验盘的问题，使得在同一组内并发进行多个写操作。所以 RAID5 既适用于大数据量的操作，也适用于各种事务处理，它是一种快速、大容量和容错分布合理的磁盘阵列。当有 N 块阵列盘时，用户空间为 $N-1$ 块盘容量。

    根据以上原理，共有 3 块 80G 的硬盘做 RAID5，则总容量为$(3-1)×80=160G$;如果有 2块 80G 的盘和 1 块 40G 的盘，则以较小的盘的容量为计算方式，总容量为$(3-1)×40=80G$。

## 网络构件关键技术

IPv4 与 IPv6 融合组网技术。目前网络演进还存在较长时间 IPv4 到 IPv6 过渡期或 IPv4 和 IPv6 网络共存期。现阶段主要存在 3 种过渡技术：双协议栈、隧道技术、网络地址翻译技术。

1. 双协议栈：两种协议在同一平台上双栈共存，同时运行。
2. 隧道技术：包括 ISATAP 隧道、6to4 隧道、over6 隧道、6over4 隧道。
3. 网络地址翻译（Network Address Translator，NAT）技术：将 IPv4 地址和 IPv6 地址分别看作内部地址和外部地址，或者相反，以实现地址转换。

## 网络构建

### 网络需求分析

网络需求分析主要从业务需求、用户需求、应用需求、计算机平台需求和网络需求来进行分析。

### 网络技术遴选及设计

网络技术遴选及设计可以使用生成树协议、虚拟局域网（VLAN）、无线局域网（WLAN）、线路冗余设计、服务器冗余设计等方式。

### 广域网技术遴选

广域网技术遴选可以采用远程接入技术、广域网互连技术，如数字数据网络（DDN）、同步数字体系（SDH）、多业务传送平台（MSTP）、虚拟专用网络（VPN）等。广域网性能优化策略有：预留带宽、利用拨号线路、传输数据压缩、链路聚合、数据基于优先级排序、基于协议预留带宽等方式。

### 层次化网络模型设计

层次化设计的优点是能降低成本，充分利用模块化设备/部件，网络变化或演化容易。层次化网络设计一般采用三层模型设计思路：接入层、汇聚层、核心层。每层的特点已经在[计算机网络基础知识](<./basics network.md>)的内容中介绍过了，这里不再赘述。

层次化设计的原则：

1. 控制网络层次。
2. 从接入层开始，向上分析规划。
3. 尽量采用模块化设计。
4. 严格控制网络结构。
5. 严格控制层次化结构。

### 网络安全控制技术

实施网络安全控制的相关技术主要有：

1. 防火墙。防护墙是网络间的安全屏障，可以保护本地网络资源。防火墙可以允许/拒绝/重定向数据流以及审计进出网络的访问或服务。防火墙的体系有：硬件防火墙、软件防火墙、嵌入式防火墙。防火墙的种类有包过滤、应用层网关、代理服务等。
2. 虚拟专用网络技术。该技术利用公共网络建立私有专用网络，具有成本低、接入方便、可扩展性强、管理和控制方便等优点。
3. 访问控制技术。访问控制技术主要有：自主访问控制（DAC）、强制访问控制（MAC）、基于角色的访问控制（RBAC）、基于任务的访问控制（TBAC）和基于对象的访问控制（OBAC）。
4. 网络安全隔离。将攻击隔离在网络外，保证网络内信息不外泄。形式有：子网隔离、物理隔离、VLAN 隔离、逻辑隔离。
5. 网络安全协议。网络安全协议可参考第 5 小时的内容，这里不再赘述。

### 网络安全审计

网络安全审计用来测试，评估和分析网络脆弱性，能够实现自动响应、数据生成、分析、浏览、事件存储、事件选择等功能。

### 绿色网络设计方法

绿色网络设计采用精简设计、重用设计、回收设计的思路。设计原则有：

1. 标准化：减少转换设备，兼容异构方案。
2. 集成化：减少设备总量，降低资源需求。
3. 虚拟化：灵活调配，按需使用。
4. 智能化：降低人力成本，降低资源占用。