---
title: 痴迷于使用原语
date: 2023-02-18
order: 2
category:
  - 重构
---

## 特征

- 使用基元而不是小对象来执行简单任务（例如货币、范围、电话号码的特殊字符串等）；
- 使用常量对信息进行编码（例如常量 USER_ADMIN_ROLE = 1 用于引用具有管理员权限的用户。）；
- 使用字符串常量作为数据数组中使用的字段名称。

## 问题的原因

和大多数其他特征一样，对于原语的痴迷是在软弱的时刻产生的。“只是一个存储一些数据的字段！”程序员说道。创建一个原始字段比创建一个全新的类容易得多，对吗？事情就这样完成了。然后需要另一个字段并以同样的方式添加。你瞧，这个类变得庞大而笨重。

原语通常用于“模拟”类型。因此，您拥有一组数字或字符串，而不是单独的数据类型，它们构成了某些实体的允许值列表。然后通过常量为这些特定的数字和字符串赋予易于理解的名称，这就是它们广泛传播的原因。

原始使用不良的另一个例子是现场模拟。该类包含大量不同的数据，并且字符串常量（在类中指定）用作获取该数据的数组索引。

## 应对方案

- 如果您有多种原始字段，则可以在逻辑上将其中一些字段分组到它们自己的类中。更好的是，将与此数据相关的行为也移到类中。对于此任务，请尝试 [将数据值替换为对象]()。
- 如果在方法参数中使用原始字段的值，请选择 [引入参数对象](../../techniques/simplifying-method-calls/introduce-parameter-object.md) 或 [保留整个对象]()。
- 当复杂数据编码在变量中时，请使用 [用类替换类型代码]()、[用子类替换类型代码]() 或 [用状态/策略替换类型代码]()。
- 如果变量中有数组，则使用 [用对象替换数组]()。

## 回报

- 由于使用对象而不是原语，代码变得更加灵活。
- 更好的代码理解性和组织性。对特定数据的操作都在同一个地方，而不是分散的。无需再猜测所有这些奇怪常量的原因以及它们为何位于数组中。
- 更容易找到重复代码。

