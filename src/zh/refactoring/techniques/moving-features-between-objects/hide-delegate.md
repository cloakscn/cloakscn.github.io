---
title: 隐藏委托
date: 2024-03-01
order: 5
category:
  - 重构
---

## 问题

客户端从对象 A 的字段或方法中获取对象 B。然后客户端调用对象B的一个方法。

![Hide Delegate - Before](https://refactoringguru.cn/images/refactoring/diagrams/Hide%20Delegate%20-%20Before.png =x150)

## 解决方法

在类 A 中创建一个新方法，将调用委托给对象 B。现在客户端不知道或不依赖于类 B。

![Hide Delegate - After](https://refactoringguru.cn/images/refactoring/diagrams/Hide%20Delegate%20-%20After.png =x150)


## 为什么要重构？

首先，让我们看一下术语：

* **服务器**是客户端可以直接访问的对象。
* **委托**是包含客户端所需功能的最终对象。

当客户端从另一个对象请求一个对象时，就会出现一个调用链，然后第二个对象请求另一个对象，依此类推。这些调用序列涉及客户端沿类结构的导航。这些相互关系的任何更改都需要在客户端进行更改。

## 好处

对客户端隐藏委派。客户端代码需要了解对象之间关系的详细信息越少，对程序进行更改就越容易。

## 缺点

如果您需要创建过多的委托方法，服务器类可能会成为不必要的中间人，从而导致过多的中间人（[Middle Man](../../code-smells/couplers/middle-man.md)）。

## 如何重构?

1. 对于客户端调用的委托类的每个方法，在服务器类中创建一个方法，将调用委托给委托类。
2. 更改客户端代码，使其调用服务器类的方法。
3. 如果您的更改使客户端不再需要委托类，则可以从服务器类（最初用于获取委托类的方法）中删除对委托类的访问方法。